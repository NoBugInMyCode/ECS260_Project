{
    "https://api.github.com/repos/vercel/micro": {
        "forks": 458,
        "watchers": 10599,
        "stars": 10599,
        "languages": {
            "TypeScript": 26604,
            "JavaScript": 5706
        },
        "commits": [
            "2024-06-08T20:32:34Z",
            "2023-01-03T13:51:15Z",
            "2023-01-02T21:04:10Z",
            "2022-11-26T21:49:29Z",
            "2022-11-26T21:47:35Z",
            "2022-11-25T21:06:28Z",
            "2022-10-02T13:44:01Z",
            "2022-08-22T03:17:04Z",
            "2022-08-04T03:14:01Z",
            "2022-07-31T16:39:33Z",
            "2022-07-31T16:38:47Z",
            "2022-07-17T21:11:22Z",
            "2022-07-17T21:11:14Z",
            "2022-07-17T21:08:10Z",
            "2022-07-07T03:00:14Z",
            "2022-07-07T02:49:59Z",
            "2022-07-07T02:42:14Z",
            "2022-05-19T21:05:09Z",
            "2022-05-19T21:04:06Z",
            "2022-05-19T21:03:40Z",
            "2022-05-19T20:59:55Z",
            "2022-05-19T20:58:26Z",
            "2021-07-30T10:21:21Z",
            "2020-06-06T12:53:19Z",
            "2020-06-02T15:22:17Z",
            "2020-05-16T15:23:12Z",
            "2020-05-13T11:56:36Z",
            "2020-01-24T10:07:32Z",
            "2019-12-31T21:56:26Z",
            "2019-11-29T14:43:37Z"
        ],
        "creation_date": "2016-01-23T05:17:00Z",
        "contributors": 30,
        "topics": [
            "async",
            "await",
            "micro",
            "microservice",
            "vercel"
        ],
        "subscribers": 178,
        "readme": "# Micro \u2014 Asynchronous HTTP microservices\n\n## Features\n\n- **Easy**: Designed for usage with `async` and `await`\n- **Fast**: Ultra-high performance (even JSON parsing is opt-in)\n- **Micro**: The whole project is ~260 lines of code\n- **Agile**: Super easy deployment and containerization\n- **Simple**: Oriented for single purpose modules (function)\n- **Standard**: Just HTTP!\n- **Explicit**: No middleware - modules declare all [dependencies](https://github.com/amio/awesome-micro)\n- **Lightweight**: With all dependencies, the package weighs less than a megabyte\n\n**Disclaimer:** Micro was created for use within containers and is not intended for use in serverless environments. For those using Vercel, this means that there is no requirement to use Micro in your projects as the benefits it provides are not applicable to the platform. Utility features provided by Micro, such as `json`, are readily available in the form of [Serverless Function helpers](https://vercel.com/docs/runtimes#official-runtimes/node-js/node-js-request-and-response-objects).\n\n## Installation\n\n**Important:** Micro is only meant to be used in production. In development, you should use [micro-dev](https://github.com/vercel/micro-dev), which provides you with a tool belt specifically tailored for developing microservices.\n\nTo prepare your microservice for running in the production environment, firstly install `micro`:\n\n```bash\nnpm install --save micro\n```\n\n## Usage\n\nCreate an `index.js` file and export a function that accepts the standard [http.IncomingMessage](https://nodejs.org/api/http.html#http_class_http_incomingmessage) and [http.ServerResponse](https://nodejs.org/api/http.html#http_class_http_serverresponse) objects:\n\n```js\nmodule.exports = (req, res) => {\n  res.end('Welcome to Micro');\n};\n```\n\nMicro provides [useful helpers](https://github.com/vercel/micro#body-parsing) but also handles return values \u2013 so you can write it even shorter!\n\n```js\nmodule.exports = () => 'Welcome to Micro';\n```\n\nNext, ensure that the `main` property inside `package.json` points to your microservice (which is inside `index.js` in this example case) and add a `start` script:\n\n```json\n{\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"micro\"\n  }\n}\n```\n\nOnce all of that is done, the server can be started like this:\n\n```bash\nnpm start\n```\n\nAnd go to this URL: `http://localhost:3000` - \ud83c\udf89\n\n### Command line\n\n```\n  micro - Asynchronous HTTP microservices\n\n  USAGE\n\n      $ micro --help\n      $ micro --version\n      $ micro [-l listen_uri [-l ...]] [entry_point.js]\n\n      By default micro will listen on 0.0.0.0:3000 and will look first\n      for the \"main\" property in package.json and subsequently for index.js\n      as the default entry_point.\n\n      Specifying a single --listen argument will overwrite the default, not supplement it.\n\n  OPTIONS\n\n      --help                              shows this help message\n\n      -v, --version                       displays the current version of micro\n\n      -l, --listen listen_uri             specify a URI endpoint on which to listen (see below) -\n                                          more than one may be specified to listen in multiple places\n\n  ENDPOINTS\n\n      Listen endpoints (specified by the --listen or -l options above) instruct micro\n      to listen on one or more interfaces/ports, UNIX domain sockets, or Windows named pipes.\n\n      For TCP (traditional host/port) endpoints:\n\n          $ micro -l tcp://hostname:1234\n\n      For UNIX domain socket endpoints:\n\n          $ micro -l unix:/path/to/socket.sock\n\n      For Windows named pipe endpoints:\n\n          $ micro -l pipe:\\\\.\\pipe\\PipeName\n```\n\n### `async` & `await`\n\n<p><details>\n  <summary><b>Examples</b></summary>\n  <ul><li><a href=\"./examples/external-api-call\">Fetch external api</a></li></ul>\n</details></p>\n\nMicro is built for usage with async/await.\n\n```js\nconst sleep = require('then-sleep');\n\nmodule.exports = async (req, res) => {\n  await sleep(500);\n  return 'Ready!';\n};\n```\n\n### Port Based on Environment Variable\n\nWhen you want to set the port using an environment variable you can use:\n\n```\nmicro -l tcp://0.0.0.0:$PORT\n```\n\nOptionally you can add a default if it suits your use case:\n\n```\nmicro -l tcp://0.0.0.0:${PORT-3000}\n```\n\n`${PORT-3000}` will allow a fallback to port `3000` when `$PORT` is not defined.\n\nNote that this only works in Bash.\n\n### Body parsing\n\n<p id=\"body-parsing-examples\"><details>\n  <summary><b>Examples</b></summary>\n  <ul>\n    <li><a href=\"./examples/json-body-parsing\">Parse JSON</a></li>\n    <li><a href=\"./examples/urlencoded-body-parsing\">Parse urlencoded form (html `form` tag)</a></li>\n  </ul>\n</details></p>\n\nFor parsing the incoming request body we included an async functions `buffer`, `text` and `json`\n\n```js\nconst { buffer, text, json } = require('micro');\n\nmodule.exports = async (req, res) => {\n  const buf = await buffer(req);\n  console.log(buf);\n  // <Buffer 7b 22 70 72 69 63 65 22 3a 20 39 2e 39 39 7d>\n  const txt = await text(req);\n  console.log(txt);\n  // '{\"price\": 9.99}'\n  const js = await json(req);\n  console.log(js.price);\n  // 9.99\n  return '';\n};\n```\n\n### API\n\n##### `buffer(req, { limit = '1mb', encoding = 'utf8' })`\n\n##### `text(req, { limit = '1mb', encoding = 'utf8' })`\n\n##### `json(req, { limit = '1mb', encoding = 'utf8' })`\n\n- Buffers and parses the incoming body and returns it.\n- Exposes an `async` function that can be run with `await`.\n- Can be called multiple times, as it caches the raw request body the first time.\n- `limit` is how much data is aggregated before parsing at max. Otherwise, an `Error` is thrown with `statusCode` set to `413` (see [Error Handling](#error-handling)). It can be a `Number` of bytes or [a string](https://www.npmjs.com/package/bytes) like `'1mb'`.\n- If JSON parsing fails, an `Error` is thrown with `statusCode` set to `400` (see [Error Handling](#error-handling))\n\nFor other types of data check the [examples](#body-parsing-examples)\n\n### Sending a different status code\n\nSo far we have used `return` to send data to the client. `return 'Hello World'` is the equivalent of `send(res, 200, 'Hello World')`.\n\n```js\nconst { send } = require('micro');\n\nmodule.exports = async (req, res) => {\n  const statusCode = 400;\n  const data = { error: 'Custom error message' };\n\n  send(res, statusCode, data);\n};\n```\n\n##### `send(res, statusCode, data = null)`\n\n- Use `require('micro').send`.\n- `statusCode` is a `Number` with the HTTP status code, and must always be supplied.\n- If `data` is supplied it is sent in the response. Different input types are processed appropriately, and `Content-Type` and `Content-Length` are automatically set.\n  - `Stream`: `data` is piped as an `octet-stream`. Note: it is _your_ responsibility to handle the `error` event in this case (usually, simply logging the error and aborting the response is enough).\n  - `Buffer`: `data` is written as an `octet-stream`.\n  - `object`: `data` is serialized as JSON.\n  - `string`: `data` is written as-is.\n- If JSON serialization fails (for example, if a cyclical reference is found), a `400` error is thrown. See [Error Handling](#error-handling).\n\n### Programmatic use\n\nYou can use Micro programmatically by requiring Micro directly:\n\n```js\nconst http = require('http');\nconst sleep = require('then-sleep');\nconst { serve } = require('micro');\n\nconst server = new http.Server(\n  serve(async (req, res) => {\n    await sleep(500);\n    return 'Hello world';\n  }),\n);\n\nserver.listen(3000);\n```\n\n##### serve(fn)\n\n- Use `require('micro').serve`.\n- Returns a function with the `(req, res) => void` signature. That uses the provided `function` as the request handler.\n- The supplied function is run with `await`. So it can be `async`\n\n##### sendError(req, res, error)\n\n- Use `require('micro').sendError`.\n- Used as the default handler for errors thrown.\n- Automatically sets the status code of the response based on `error.statusCode`.\n- Sends the `error.message` as the body.\n- Stacks are printed out with `console.error` and during development (when `NODE_ENV` is set to `'development'`) also sent in responses.\n- Usually, you don't need to invoke this method yourself, as you can use the [built-in error handling](#error-handling) flow with `throw`.\n\n##### createError(code, msg, orig)\n\n- Use `require('micro').createError`.\n- Creates an error object with a `statusCode`.\n- Useful for easily throwing errors with HTTP status codes, which are interpreted by the [built-in error handling](#error-handling).\n- `orig` sets `error.originalError` which identifies the original error (if any).\n\n## Error Handling\n\nMicro allows you to write robust microservices. This is accomplished primarily by bringing sanity back to error handling and avoiding callback soup.\n\nIf an error is thrown and not caught by you, the response will automatically be `500`. **Important:** Error stacks will be printed as `console.error` and during development mode (if the env variable `NODE_ENV` is `'development'`), they will also be included in the responses.\n\nIf the `Error` object that's thrown contains a `statusCode` property, that's used as the HTTP code to be sent. Let's say you want to write a rate limiting module:\n\n```js\nconst rateLimit = require('my-rate-limit');\n\nmodule.exports = async (req, res) => {\n  await rateLimit(req);\n  // ... your code\n};\n```\n\nIf the API endpoint is abused, it can throw an error with `createError` like so:\n\n```js\nif (tooMany) {\n  throw createError(429, 'Rate limit exceeded');\n}\n```\n\nAlternatively you can create the `Error` object yourself\n\n```js\nif (tooMany) {\n  const err = new Error('Rate limit exceeded');\n  err.statusCode = 429;\n  throw err;\n}\n```\n\nThe nice thing about this model is that the `statusCode` is merely a suggestion. The user can override it:\n\n```js\ntry {\n  await rateLimit(req);\n} catch (err) {\n  if (429 == err.statusCode) {\n    // perhaps send 500 instead?\n    send(res, 500);\n  }\n}\n```\n\nIf the error is based on another error that **Micro** caught, like a `JSON.parse` exception, then `originalError` will point to it. If a generic error is caught, the status will be set to `500`.\n\nIn order to set up your own error handling mechanism, you can use composition in your handler:\n\n```js\nconst { send } = require('micro');\n\nconst handleErrors = (fn) => async (req, res) => {\n  try {\n    return await fn(req, res);\n  } catch (err) {\n    console.log(err.stack);\n    send(res, 500, 'My custom error!');\n  }\n};\n\nmodule.exports = handleErrors(async (req, res) => {\n  throw new Error('What happened here?');\n});\n```\n\n## Testing\n\nMicro makes tests compact and a pleasure to read and write.\nWe recommend [Node TAP](https://node-tap.org/) or [AVA](https://github.com/avajs/ava), a highly parallel test framework with built-in support for async tests:\n\n```js\nconst http = require('http');\nconst { send, serve } = require('micro');\nconst test = require('ava');\nconst listen = require('test-listen');\nconst fetch = require('node-fetch');\n\ntest('my endpoint', async (t) => {\n  const service = new http.Server(\n    serve(async (req, res) => {\n      send(res, 200, {\n        test: 'woot',\n      });\n    }),\n  );\n\n  const url = await listen(service);\n  const response = await fetch(url);\n  const body = await response.json();\n\n  t.deepEqual(body.test, 'woot');\n  service.close();\n});\n```\n\nLook at [test-listen](https://github.com/vercel/test-listen) for a\nfunction that returns a URL with an ephemeral port every time it's called.\n\n## Contributing\n\n1. [Fork](https://help.github.com/articles/fork-a-repo/) this repository to your own GitHub account and then [clone](https://help.github.com/articles/cloning-a-repository/) it to your local device\n2. Link the package to the global module directory: `npm link`\n3. Within the module you want to test your local development instance of Micro, just link it to the dependencies: `npm link micro`. Instead of the default one from npm, node will now use your clone of Micro!\n\nYou can run the tests using: `npm test`.\n\n## Credits\n\nThanks to Tom Yandell and Richard Hodgson for donating the name \"micro\" on [npm](https://www.npmjs.com)!\n\n## Authors\n\n- Guillermo Rauch ([@rauchg](https://x.com/rauchg)) - [Vercel](https://vercel.com)\n- Leo Lamprecht ([@leo](https://x.com/leo)) - [Vercel](https://vercel.com)\n- Tim Neutkens ([@timneutkens](https://x.com/timneutkens)) - [Vercel](https://vercel.com)\n",
        "releases": [
            {
                "name": "v10.0.1",
                "date": "2022-11-26T21:51:06Z"
            },
            {
                "name": "v10.0.0",
                "date": "2022-11-25T21:10:26Z"
            },
            {
                "name": "9.4.1",
                "date": "2022-07-31T16:41:29Z"
            },
            {
                "name": "9.4.0",
                "date": "2022-07-17T21:16:23Z"
            },
            {
                "name": "v9.3.5-canary.3",
                "date": "2019-07-22T13:51:06Z"
            },
            {
                "name": "",
                "date": "2019-07-01T14:45:44Z"
            },
            {
                "name": "",
                "date": "2019-05-13T11:38:59Z"
            },
            {
                "name": "",
                "date": "2019-05-12T12:33:26Z"
            },
            {
                "name": "",
                "date": "2019-05-02T13:42:24Z"
            },
            {
                "name": null,
                "date": "2018-08-09T09:05:36Z"
            },
            {
                "name": null,
                "date": "2018-05-29T16:26:22Z"
            },
            {
                "name": null,
                "date": "2018-05-15T11:42:22Z"
            },
            {
                "name": null,
                "date": "2018-04-24T04:11:48Z"
            },
            {
                "name": "",
                "date": "2018-04-23T18:11:24Z"
            },
            {
                "name": null,
                "date": "2018-03-11T04:32:44Z"
            },
            {
                "name": null,
                "date": "2018-03-11T04:31:47Z"
            },
            {
                "name": "",
                "date": "2018-03-10T02:48:51Z"
            },
            {
                "name": "",
                "date": "2018-03-10T02:25:36Z"
            },
            {
                "name": null,
                "date": "2018-01-08T18:31:40Z"
            },
            {
                "name": null,
                "date": "2017-11-20T10:32:43Z"
            },
            {
                "name": "",
                "date": "2017-11-03T22:33:42Z"
            },
            {
                "name": "",
                "date": "2017-09-12T16:45:19Z"
            },
            {
                "name": "",
                "date": "2017-08-31T11:50:56Z"
            },
            {
                "name": "",
                "date": "2017-08-17T16:10:17Z"
            },
            {
                "name": "",
                "date": "2017-08-10T14:00:24Z"
            },
            {
                "name": "",
                "date": "2017-08-01T21:36:08Z"
            },
            {
                "name": "",
                "date": "2017-08-01T17:32:23Z"
            },
            {
                "name": "",
                "date": "2017-05-08T12:31:44Z"
            },
            {
                "name": "",
                "date": "2017-04-13T11:27:08Z"
            },
            {
                "name": "",
                "date": "2017-04-11T17:14:48Z"
            },
            {
                "name": "",
                "date": "2017-03-27T14:46:31Z"
            },
            {
                "name": "",
                "date": "2017-03-25T13:37:20Z"
            },
            {
                "name": "",
                "date": "2017-03-21T08:30:17Z"
            },
            {
                "name": "",
                "date": "2017-03-20T18:02:56Z"
            },
            {
                "name": "",
                "date": "2017-03-06T11:39:10Z"
            },
            {
                "name": "",
                "date": "2017-02-10T17:38:05Z"
            },
            {
                "name": "",
                "date": "2017-02-10T17:32:12Z"
            },
            {
                "name": "",
                "date": "2017-02-10T16:18:11Z"
            },
            {
                "name": "",
                "date": "2017-02-06T13:25:04Z"
            },
            {
                "name": "",
                "date": "2017-02-05T22:25:56Z"
            },
            {
                "name": "",
                "date": "2017-02-05T10:11:20Z"
            },
            {
                "name": "",
                "date": "2017-02-04T21:26:51Z"
            },
            {
                "name": "",
                "date": "2017-01-26T17:49:23Z"
            },
            {
                "name": "",
                "date": "2017-01-15T11:47:05Z"
            },
            {
                "name": "",
                "date": "2016-10-08T15:14:08Z"
            },
            {
                "name": "",
                "date": "2016-08-31T15:44:11Z"
            },
            {
                "name": "Micro 6.0.1",
                "date": "2016-08-13T02:01:10Z"
            },
            {
                "name": "Micro 6.0.0",
                "date": "2016-08-13T01:06:07Z"
            },
            {
                "name": "",
                "date": "2016-08-08T10:40:54Z"
            },
            {
                "name": "",
                "date": "2016-07-28T10:00:21Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:59:56Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:59:29Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:59:09Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:58:50Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:58:28Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:58:16Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:57:54Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:57:24Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:57:02Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:56:10Z"
            },
            {
                "name": "",
                "date": "2016-07-28T09:55:39Z"
            }
        ]
    }
}