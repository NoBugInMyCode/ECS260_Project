{
    "https://api.github.com/repos/Tencent/matrix": {
        "forks": 1890,
        "watchers": 11713,
        "stars": 11713,
        "languages": {
            "Java": 3120265,
            "C++": 3104837,
            "C": 2017987,
            "Kotlin": 349350,
            "Objective-C++": 344434,
            "Objective-C": 286447,
            "Python": 52886,
            "CMake": 40470,
            "Yacc": 39440,
            "Ruby": 5037,
            "AIDL": 1683,
            "Shell": 1513,
            "Awk": 1229,
            "Makefile": 64
        },
        "commits": [
            "2023-07-31T12:55:09Z",
            "2023-03-21T11:48:44Z",
            "2023-03-21T11:47:51Z",
            "2023-03-21T08:39:37Z",
            "2023-03-21T08:33:50Z",
            "2023-03-21T08:26:22Z",
            "2023-03-21T08:07:05Z",
            "2023-03-21T07:21:09Z",
            "2023-03-21T06:36:18Z",
            "2023-03-21T06:18:14Z",
            "2023-03-21T06:08:16Z",
            "2023-03-15T01:35:48Z",
            "2023-03-14T07:05:28Z",
            "2023-03-14T02:14:52Z",
            "2023-03-13T11:45:46Z",
            "2023-03-09T18:43:25Z",
            "2023-03-09T10:39:50Z",
            "2023-03-09T10:35:35Z",
            "2023-03-08T09:45:35Z",
            "2023-03-08T08:39:59Z",
            "2023-03-02T07:17:17Z",
            "2023-03-02T07:01:29Z",
            "2023-03-01T05:23:35Z",
            "2023-03-01T04:19:47Z",
            "2023-02-28T13:22:33Z",
            "2023-02-20T08:04:42Z",
            "2023-02-20T03:58:36Z",
            "2023-02-20T03:55:17Z",
            "2023-02-17T03:00:24Z",
            "2023-02-17T02:57:43Z"
        ],
        "creation_date": "2018-12-11T07:08:02Z",
        "contributors": 30,
        "topics": [
            "android",
            "apm-client",
            "wechat"
        ],
        "subscribers": 272,
        "readme": "![Matrix-icon](assets/img/readme/header.png)\n[![license](http://img.shields.io/badge/license-BSD3-brightgreen.svg?style=flat)](https://github.com/Tencent/matrix/blob/master/LICENSE)\n[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Tencent/matrix/pulls)\n[![WeChat Approved](https://img.shields.io/badge/Wechat%20Approved-2.1.0-red.svg)](https://github.com/Tencent/matrix/wiki)\n[![CircleCI](https://circleci.com/gh/Tencent/matrix.svg?style=shield)](https://app.circleci.com/pipelines/github/Tencent/matrix)\n\n(\u4e2d\u6587\u7248\u672c\u8bf7\u53c2\u770b[\u8fd9\u91cc](#matrix_cn))  \n\n[Matrix for iOS/macOS \u4e2d\u6587\u7248](#matrix_ios_cn)  \n[Matrix for android \u4e2d\u6587\u7248](#matrix_android_cn)   \n[Matrix for iOS/macOS](#matrix_ios_en)   \n[Matrix for android](#matrix_android_en)   \n\n**Matrix** is an APM (Application Performance Manage) used in Wechat to monitor, locate and analyse performance problems. It is a **plugin style**, **non-invasive** solution and is currently available on iOS, macOS and Android.\n\n# <a name='matrix_ios_en'> Matrix for iOS/macOS </a>\n\nThe monitoring scope of the current tool includes: crash, lag, and memory, which includes the following three plugins:\n\n* **WCCrashBlockMonitorPlugin\uff1a** Based on [KSCrash](https://github.com/kstenerud/KSCrash) framework, it features cutting-edge lag stack capture capabilities with crash capture.\n\n* **WCMemoryStatPlugin\uff1a** A memory monitoring tool that captures memory allocation and the callstack of an application's memory event.\n\n* **WCFPSMonitorPlugin\uff1a** A fps monitoring tool that captures main thread's callstack while user scrolling.\n\n## Features\n\n#### WCCrashBlockMonitorPlugin\n\n* Easy integration, no code intrusion.\n* Determine whether the app is stuck by checking the running status of the Runloop, and support both the iOS and macOS platform.\n* Add time-consuming stack fetching, attaching the most time-consuming main thread stack to the thread snapshot log.\n\n#### WCMemoryStatPlugin\n\n* Live recording every object's creating and the corresponding callstack of its creation, and report it when the application out-of-memory is detected.\n\n## Getting Started\n#### Install\n\n* **Install with static framework**\n  1. Get source code of Matrix;\n  2. Open terminal, execute `make` in the `matrix/matrix-iOS` directory to compile and generate static library. After compiling, the iOS platform library is in the `matrix/matrix-iOS/build_ios` directory, and the macOS platform library is in the `matrix/matrix-iOS/build_macos` directory.\n  3. Link with static framework in the project:\n    * iOS : Use `Matrix.framework` under the `matrix/matrix-iOS/build_ios` path, link `Matrix.framework` to the project as a static library;\n    * macOS : Use `Matrix.framework` under the `matrix/matrix-iOS/build_macos` path, link `Matrix.framework` to the project as a static library.\n  4. Add `#import <Matrix/Matrix.h>`, then you can use the performance probe tool of WeChat.\n\n#### Start the plugins\n\nIn the following places:\n\n* Program `main` function;\n* `application:didFinishLaunchingWithOptions:` of  `AppDelegate`;\n* Or other places running as earlier as possible after application launching.\n\nAdd a code similar to the following to start the plugin:\n\n```objective-c\n#import <Matrix/Matrix.h>\n  \nMatrix *matrix = [Matrix sharedInstance];\nMatrixBuilder *curBuilder = [[MatrixBuilder alloc] init];\ncurBuilder.pluginListener = self; // get the related event of plugin via the callback of the pluginListener\n    \nWCCrashBlockMonitorPlugin *crashBlockPlugin = [[WCCrashBlockMonitorPlugin alloc] init];    \n[curBuilder addPlugin:crashBlockPlugin]; // add lag and crash monitor.\n    \nWCMemoryStatPlugin *memoryStatPlugin = [[WCMemoryStatPlugin alloc] init];\n[curBuilder addPlugin:memoryStatPlugin]; // add memory monitor.\n\nWCFPSMonitorPlugin *fpsMonitorPlugin = [[WCFPSMonitorPlugin alloc] init];\n[curBuilder addPlugin:fpsMonitorPlugin]; // add fps monitor.\n    \n[matrix addMatrixBuilder:curBuilder];\n    \n[crashBlockPlugin start]; // start the lag and crash monitor.\n[memoryStatPlugin start]; // start memory monitor\n[fpsMonitorPlugin start]; // start fps monitor\n```\n\n#### Receive callbacks to obtain monitoring data\n\nSet `pluginListener` of the `MatrixBuilder` object, implement the `MatrixPluginListenerDelegate`\n\n```objective-c\n// set delegate\n\nMatrixBuilder *curBuilder = [[MatrixBuilder alloc] init];\ncurBuilder.pluginListener = <object conforms to MatrixPluginListenerDelegate>; \n\n// MatrixPluginListenerDelegate\n\n- (void)onInit:(id<MatrixPluginProtocol>)plugin;\n- (void)onStart:(id<MatrixPluginProtocol>)plugin;\n- (void)onStop:(id<MatrixPluginProtocol>)plugin;\n- (void)onDestroy:(id<MatrixPluginProtocol>)plugin;\n- (void)onReportIssue:(MatrixIssue *)issue;\n```\n\nEach plugin added to `MatrixBuilder` will call back the corresponding event via `pluginListener`.\n\n**Important: Get the monitoring data of the Matrix via `onReportIssue:`, the data format info reference to [Matrix for iOS/macOS Data Format Description](https://github.com/Tencent/matrix/wiki/Matrix-for-iOS-macOS-Data-Format-Description)**\n\n## Tutorials\n\nAt this point, Matrix has been integrated into the app and is beginning to collect crash, lag, and memory data. If you still have questions, check out the example: `samples/sample-iOS/MatrixDemo`.\n\n\n\n# <a name='matrix_android_en'> Matrix for android </a>\n\n## Plugins\n\n- **APK Checker:**\n\n  Analyse the APK package, give suggestions of reducing the APK's size; Compare two APK and find out the most significant increment on size\n\n- **Resource Canary:**\n\n  Detect the activity leak and bitmap duplication basing on WeakReference and [Square Haha](https://github.com/square/haha) \n\n- **Trace Canary:**\n\n  FPS Monitor, Startup Performance, ANR, UI-Block / Slow Method Detection\n\n- **SQLite Lint:**\n\n  Evaluate the quality of SQLite statement automatically by using SQLite official tools\n\n- **IO Canary:**\n\n  Detect the file IO issues, including performance of file IO and closeable leak \n\n- **Battery Canary:**\n\n  App thread activities monitor (Background watch & foreground loop watch), Sonsor usage monitor (WakeLock/Alarm/Gps/Wifi/Bluetooth), Background network activities (Wifi/Mobile) monitor.\n  \n- **MemGuard**\n\n  Detect heap memory overlap, use-after-free and double free issues.\n\n\n## Features\n#### APK Checker\n\n- **Easy-to-use.** Matrix provides a JAR tool, which is more convenient to apply to your integration systems. \n- **More features.** In addition to APK Analyzer, Matrix find out the R redundancies, the dynamic libraries statically linked STL, unused resources, and supports custom checking rules.\n- **Visual Outputs.** supports HTML and JSON outputs.\n\n#### Resource Canary\n\n- **Separated detection and analysis.** Make possible to use in automated test and in release versions (monitor only).\n- **Pruned Hprof.** Remove the useless data in hprof and easier to upload.\n- **Detection of duplicate bitmap.** \n\n#### Trace Canary\n\n- **High performance.** Dynamically modify bytecode at compile time, record function cost and call stack with little performance loss.\n- **Accurate call stack of ui-block.** Provide informations such as call stack, function cost, execution times to solve the problem of ui-block quickly.\n- **Non-hack.** High compatibility to Android versions.\n- **More features.** Automatically covers multiple fluency indicators such as ui-block, startup time, activity switching, slow function detection.\n- **High-accuracy ANR detector.**  Detect ANRs accurately and give ANR trace file with high compatibility and high stability.\n\n#### SQLite Lint\n\n- **Easy-to-use.** Non-invasive.\n- **High applicability.** Regardless of the amount of data, you can discover SQLite performance problems during development and testing.\n- **High standards.** Detection algorithms based on best practices, make SQLite statements to the highest quality.\n- **May support multi-platform.** Implementing in C++ makes it possible to support multi-platform.\n\n#### IO Canary\n- **Easy-to-use.** Non-invasive.\n- **More feature.** Including performance of file IO and closeable leak.\n- **Compatible with Android P.**\n\n#### Battery Canary\n- **Easy-to-use.** Use out of box (unit tests as example).\n- **More feature.** Flexible extending with base and utils APIs.\n\n#### Memory Hook\n\n- A native memory leak detection tool for Android.\n- **Non-invasive.** It is based on PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook)), so we do NOT need to recompile the native libraries.\n- **High performance.** we use WeChat-Backtrace for fast unwinding which supports both aarch64 and armeabi-v7a architectures.\n\n#### Pthread Hook\n\n- A Java and native thread leak detection and native thread stack space trimming tool for Android.\n- **Non-invasive.** It is based on PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook)), so we do NOT need to recompile the native libraries.\n- It saves virtual memory overhead by trimming default stack size of native thread in half, which can reduce crashes caused by virtual memory insufficient under 32bit environment.\n\n#### WVPreAllocHook\n\n+ A tool for saving virtual memory overhead caused by WebView preloading when WebView is not actually used. It's useful for reducing crashes caused by virtual memory insufficient under 32bit environment.\n+ **Non-invasive.** It is based on PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook)), so we do NOT need to recompile the native libraries.\n+ WebView still works after using this tool.\n\n#### MemGuard\n\n+ A tool base on GWP-Asan to detect heap memory issues.\n+ **Non-invasive.** It is based on PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook)), so we do NOT need to recompile the native libraries.\n+ It's able to apply on specific libraries that needs to be detected by RegEx.\n\n+ It detects heap memory accessing overlap, use-after-free and double free issues.\n\n\n#### Backtrace Component\n\n- A fast native backtrace component designed by Matrix based on quicken unwind tables that are generated and simplified from DWARF and ARM exception handling informations. It is about 15x ~ 30x faster than libunwindstack.\n\n\n## Getting Started\n***The JCenter repository will stop service on February 1, 2022. So we uploaded Matrix(since 0.8.0) to the MavenCentral repository.***\n\n1. Configure `MATRIX_VERSION` in gradle.properties.\n``` gradle\n  MATRIX_VERSION=2.1.0\n```\n\n2. Add `matrix-gradle-plugin` in your build.gradle:\n``` gradle \n  dependencies {\n      classpath (\"com.tencent.matrix:matrix-gradle-plugin:${MATRIX_VERSION}\") { changing = true }\n  }\n \n```\n3. Add dependencies to your app/build.gradle.\n\n``` gradle\n  dependencies {\n    implementation group: \"com.tencent.matrix\", name: \"matrix-android-lib\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-android-commons\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-trace-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-resource-canary-android\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-resource-canary-common\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-io-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-sqlite-lint-android-sdk\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-battery-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-hooks\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-backtrace\", version: MATRIX_VERSION, changing: true\n  }\n  \n  apply plugin: 'com.tencent.matrix-plugin'\n  matrix {\n    trace {\n        enable = true\t//if you don't want to use trace canary, set false\n        baseMethodMapFile = \"${project.buildDir}/matrix_output/Debug.methodmap\"\n        blackListFile = \"${project.projectDir}/matrixTrace/blackMethodList.txt\"\n    }\n  }\n```\n\n4. Implement `PluginListener` to receive data processed by Matrix.\n\n``` java\n  public class TestPluginListener extends DefaultPluginListener {\n    public static final String TAG = \"Matrix.TestPluginListener\";\n    public TestPluginListener(Context context) {\n        super(context);\n        \n    }\n\n    @Override\n    public void onReportIssue(Issue issue) {\n        super.onReportIssue(issue);\n        MatrixLog.e(TAG, issue.toString());\n        \n        //add your code to process data\n    }\n}\n```\n\nMatrix gradle plugin could work with Android Gradle Plugin 3.5.0/4.0.0/4.1.0 currently.\n\n5. Implement `DynamicConfig` to change parameters of Matrix.\n``` java\n  public class DynamicConfigImplDemo implements IDynamicConfig {\n    public DynamicConfigImplDemo() {}\n\n    public boolean isFPSEnable() { return true;}\n    public boolean isTraceEnable() { return true; }\n    public boolean isMatrixEnable() { return true; }\n    public boolean isDumpHprof() {  return false;}\n\n    @Override\n    public String get(String key, String defStr) {\n        //hook to change default values\n    }\n\n    @Override\n    public int get(String key, int defInt) {\n      //hook to change default values\n    }\n\n    @Override\n    public long get(String key, long defLong) {\n        //hook to change default values\n    }\n\n    @Override\n    public boolean get(String key, boolean defBool) {\n        //hook to change default values\n    }\n\n    @Override\n    public float get(String key, float defFloat) {\n        //hook to change default values\n    }\n}\n```\n\n6. Init Matrix in the ```onCreate``` of your application. \n\n``` java \n  Matrix.Builder builder = new Matrix.Builder(application); // build matrix\n  builder.patchListener(new TestPluginListener(this)); // add general pluginListener\n  DynamicConfigImplDemo dynamicConfig = new DynamicConfigImplDemo(); // dynamic config\n  \n  // init plugin \n  IOCanaryPlugin ioCanaryPlugin = new IOCanaryPlugin(new IOConfig.Builder()\n                    .dynamicConfig(dynamicConfig)\n                    .build());\n  //add to matrix               \n  builder.plugin(ioCanaryPlugin);\n  \n  //init matrix\n  Matrix.init(builder.build());\n\n  // start plugin \n  ioCanaryPlugin.start();\n```\nFor more Matrix configurations, look at the [sample](https://github.com/Tencent/matrix/tree/dev/samples/sample-android).\n\nNote:\n1. Since Matrix for Android has migrated to AndroidX since v0.9.0. You may need to add 'android.useAndroidX=true' flag to gradle.properties\n2. You can get more about Matrix output at the wiki [The output of Matrix](https://github.com/Tencent/matrix/wiki/Matrix-Android--data-format); \n\n\n#### Battery Canary Usage\n\nInit BatteryCanary as the following codes:\n```java\nBatteryMonitorConfig config = new BatteryMonitorConfig.Builder()\n        .enable(JiffiesMonitorFeature.class)\n        .enableStatPidProc(true)\n        .greyJiffiesTime(30 * 1000L)\n        .setCallback(new BatteryMonitorCallback.BatteryPrinter())\n        .build();\n\nBatteryMonitorPlugin plugin = new BatteryMonitorPlugin(config);\n```\n\nFor detail usage, please reference showcase tests at `com.tencent.matrix.batterycanary.ApisTest` or `sample.tencent.matrix.battery.BatteryCanaryInitHelper`.\n\n#### Backtrace Component Usage\n\nHow to init backtrace component\uff1a\n```java\nWeChatBacktrace.instance().configure(getApplicationContext()).commit();\n```\n\nThen other components in Matrix could use Quikcen Backtrace to unwind stacktrace. See more configuration comments in 'WeChatBacktrace.Configuration'.\n\n#### APK Checker Usage\n\nAPK Checker can run independently in Jar ([matrix-apk-canary-2.1.0.jar](https://repo.maven.apache.org/maven2/com/tencent/matrix/matrix-apk-canary/2.1.0/matrix-apk-canary-2.1.0.jar)\uff09  mode, usage:\n\n\n```shell\njava -jar matrix-apk-canary-2.1.0.jar\nUsages: \n    --config CONFIG-FILE-PATH\nor\n    [--input INPUT-DIR-PATH] [--apk APK-FILE-PATH] [--unzip APK-UNZIP-PATH] [--mappingTxt MAPPING-FILE-PATH] [--resMappingTxt RESGUARD-MAPPING-FILE-PATH] [--output OUTPUT-PATH] [--format OUTPUT-FORMAT] [--formatJar OUTPUT-FORMAT-JAR] [--formatConfig OUTPUT-FORMAT-CONFIG (json-array format)] [Options]\n    \nOptions:\n-manifest\n     Read package info from the AndroidManifest.xml.\n-fileSize [--min DOWN-LIMIT-SIZE (KB)] [--order ORDER-BY ('asc'|'desc')] [--suffix FILTER-SUFFIX-LIST (split by ',')]\n     Show files whose size exceed limit size in order.\n-countMethod [--group GROUP-BY ('class'|'package')]\n     Count methods in dex file, output results group by class name or package name.\n-checkResProguard\n     Check if the resguard was applied.\n-findNonAlphaPng [--min DOWN-LIMIT-SIZE (KB)]\n     Find out the non-alpha png-format files whose size exceed limit size in desc order.\n-checkMultiLibrary\n     Check if there are more than one library dir in the 'lib'.\n-uncompressedFile [--suffix FILTER-SUFFIX-LIST (split by ',')]\n     Show uncompressed file types.\n-countR\n     Count the R class.\n-duplicatedFile\n     Find out the duplicated resource files in desc order.\n-checkMultiSTL  --toolnm TOOL-NM-PATH\n     Check if there are more than one shared library statically linked the STL.\n-unusedResources --rTxt R-TXT-FILE-PATH [--ignoreResources IGNORE-RESOURCES-LIST (split by ',')]\n     Find out the unused resources.\n-unusedAssets [--ignoreAssets IGNORE-ASSETS-LIST (split by ',')]\n     Find out the unused assets file.\n-unstrippedSo  --toolnm TOOL-NM-PATH\n     Find out the unstripped shared library file.\n```\n\nLearn more about [Matrix-APKChecker](https://github.com/Tencent/matrix/wiki/Matrix-Android-ApkChecker) \n\n\n# Support\n\nAny problem?\n\n1. Learn more from [Sample](https://github.com/Tencent/matrix/tree/master/samples/)\n2. [Source Code](https://github.com/Tencent/matrix/tree/master/matrix)\n3. [Wiki](https://github.com/Tencent/matrix/wiki) & [FAQ](https://github.com/Tencent/Matrix/wiki/Matrix-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)\n4. Contact us for help\n\n# Contributing\n\nIf you are interested in contributing, check out the [CONTRIBUTING.md](https://github.com/Tencent/Matrix/blob/master/CONTRIBUTING.md), also join our [Tencent OpenSource Plan](https://opensource.tencent.com/contribution).\n\n# License\n\nMatrix is under the BSD license. See the [LICENSE](https://github.com/Tencent/Matrix/blob/master/LICENSE) file for details\n\n------\n\n# <a name=\"matrix_cn\">Matrix</a>\n![Matrix-icon](assets/img/readme/header.png)\n[![license](http://img.shields.io/badge/license-BSD3-brightgreen.svg?style=flat)](https://github.com/Tencent/matrix/blob/master/LICENSE)[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/Tencent/matrix/pulls)  [![WeChat Approved](https://img.shields.io/badge/Wechat%20Approved-2.1.0-red.svg)](https://github.com/Tencent/matrix/wiki)\n\n**Matrix** \u662f\u4e00\u6b3e\u5fae\u4fe1\u7814\u53d1\u5e76\u65e5\u5e38\u4f7f\u7528\u7684\u5e94\u7528\u6027\u80fd\u63a5\u5165\u6846\u67b6\uff0c\u652f\u6301iOS, macOS\u548cAndroid\u3002\nMatrix \u901a\u8fc7\u63a5\u5165\u5404\u79cd\u6027\u80fd\u76d1\u63a7\u65b9\u6848\uff0c\u5bf9\u6027\u80fd\u76d1\u63a7\u9879\u7684\u5f02\u5e38\u6570\u636e\u8fdb\u884c\u91c7\u96c6\u548c\u5206\u6790\uff0c\u8f93\u51fa\u76f8\u5e94\u7684\u95ee\u9898\u5206\u6790\u3001\u5b9a\u4f4d\u4e0e\u4f18\u5316\u5efa\u8bae\uff0c\u4ece\u800c\u5e2e\u52a9\u5f00\u53d1\u8005\u5f00\u53d1\u51fa\u66f4\u9ad8\u8d28\u91cf\u7684\u5e94\u7528\u3002\n\n# <a name='matrix_ios_cn'>Matrix for iOS/macOS </a>\n\nMatrix-iOS \u5f53\u524d\u5de5\u5177\u76d1\u63a7\u8303\u56f4\u5305\u62ec\uff1a\u5d29\u6e83\u3001\u5361\u987f\u548c\u5185\u5b58\uff0c\u5305\u542b\u4ee5\u4e0b\u4e09\u6b3e\u63d2\u4ef6\uff1a\n\n* **WCCrashBlockMonitorPlugin\uff1a** \u57fa\u4e8e [KSCrash](https://github.com/kstenerud/KSCrash) \u6846\u67b6\u5f00\u53d1\uff0c\u5177\u6709\u4e1a\u754c\u9886\u5148\u7684\u5361\u987f\u5806\u6808\u6355\u83b7\u80fd\u529b\uff0c\u540c\u65f6\u517c\u5907\u5d29\u6e83\u6355\u83b7\u80fd\u529b\n\n* **WCMemoryStatPlugin\uff1a** \u4e00\u6b3e\u6027\u80fd\u6781\u81f4\u7684\u5185\u5b58\u76d1\u63a7\u5de5\u5177\uff0c\u80fd\u591f\u5168\u9762\u6355\u83b7\u5e94\u7528 OOM \u65f6\u7684\u5185\u5b58\u5206\u914d\u4ee5\u53ca\u8c03\u7528\u5806\u6808\u60c5\u51b5\n\n* **WCFPSMonitorPlugin\uff1a** \u4e00\u6b3e FPS \u76d1\u63a7\u5de5\u5177\uff0c\u5f53\u7528\u6237\u6ed1\u52a8\u754c\u9762\u65f6\uff0c\u8bb0\u5f55\u4e3b\u7ebf\u7a0b\u8c03\u7528\u6808\n\n## \u7279\u6027\n\n#### WCCrashBlockMonitorPlugin\n\n* \u63a5\u5165\u7b80\u5355\uff0c\u4ee3\u7801\u65e0\u4fb5\u5165\n* \u901a\u8fc7\u68c0\u67e5 Runloop \u8fd0\u884c\u72b6\u6001\u5224\u65ad\u5e94\u7528\u662f\u5426\u5361\u987f\uff0c\u540c\u65f6\u652f\u6301 iOS/macOS \u5e73\u53f0\n* \u589e\u52a0\u8017\u65f6\u5806\u6808\u63d0\u53d6\uff0c\u5361\u987f\u7ebf\u7a0b\u5feb\u7167\u65e5\u5fd7\u4e2d\u9644\u52a0\u6700\u8fd1\u65f6\u95f4\u6700\u8017\u65f6\u7684\u4e3b\u7ebf\u7a0b\u5806\u6808\n\n#### WCMemoryStatPlugin\n\n* \u5728\u5e94\u7528\u8fd0\u884c\u671f\u95f4\u83b7\u53d6\u5bf9\u8c61\u5b58\u6d3b\u4ee5\u53ca\u76f8\u5e94\u7684\u5806\u6808\u4fe1\u606f\uff0c\u5728\u68c0\u6d4b\u5230\u5e94\u7528 OOM \u65f6\u8fdb\u884c\u4e0a\u62a5\n\n## \u4f7f\u7528\u65b9\u6cd5\n\n#### \u5b89\u88c5\n\n* **\u901a\u8fc7\u9759\u6001\u5e93\u5b89\u88c5**\n  1. \u83b7\u53d6 Matrix \u6e90\u7801\uff1b\n  2. \u6253\u5f00\u547d\u4ee4\u884c\uff0c\u5728 `matrix/matrix-iOS` \u4ee3\u7801\u76ee\u5f55\u4e0b\u6267\u884c `make` \u8fdb\u884c\u7f16\u8bd1\u751f\u6210\u9759\u6001\u5e93\uff1b\u7f16\u8bd1\u5b8c\u6210\u540e\uff0ciOS \u5e73\u53f0\u7684\u5e93\u5728 `matrix/matrix-iOS/build_ios` \u76ee\u5f55\u4e0b\uff0cmacOS \u5e73\u53f0\u7684\u5e93\u5728 `matrix/matrix-iOS/build_macos` \u76ee\u5f55\u4e0b\uff1b\n  3. \u5de5\u7a0b\u5f15\u5165\u9759\u6001\u5e93\uff1a\n    * iOS \u5e73\u53f0\uff1a\u4f7f\u7528 `matrix/matrix-iOS/build_ios` \u8def\u5f84\u4e0b\u7684 `Matrix.framework`\uff0c\u5c06 `Matrix.framework` \u4ee5\u9759\u6001\u5e93\u7684\u65b9\u5f0f\u5f15\u5165\u5de5\u7a0b\uff1b\n    * macOS \u5e73\u53f0\uff1a\u4f7f\u7528 `matrix/matrix-iOS/build_macos` \u8def\u5f84\u4e0b\u7684 `Matrix.framework`\uff0c\u5c06 `Matrix.framework` \u4ee5\u9759\u6001\u5e93\u7684\u65b9\u5f0f\u5f15\u5165\u5de5\u7a0b\u3002\n  4. \u6dfb\u52a0\u5934\u6587\u4ef6 `#import <Matrix/Matrix.h>`\uff0c\u5c31\u53ef\u4ee5\u63a5\u5165\u5fae\u4fe1\u7684\u6027\u80fd\u63a2\u9488\u5de5\u5177\u4e86\uff01\n\n\n#### \u542f\u52a8\u76d1\u63a7\n\n\u5728\u4ee5\u4e0b\u5730\u65b9\uff1a\n\n* \u7a0b\u5e8f `main` \u51fd\u6570\u5165\u53e3\uff1b\n* `AppDelegate` \u4e2d\u7684 `application:didFinishLaunchingWithOptions:`\uff1b\n* \u6216\u8005\u5176\u4ed6\u5e94\u7528\u542f\u52a8\u6bd4\u8f83\u65e9\u7684\u65f6\u95f4\u70b9\u3002\n\n\u6dfb\u52a0\u7c7b\u4f3c\u5982\u4e0b\u4ee3\u7801\uff0c\u542f\u52a8\u63d2\u4ef6\uff1a\n\n```\n#import <Matrix/Matrix.h>\n  \nMatrix *matrix = [Matrix sharedInstance];\nMatrixBuilder *curBuilder = [[MatrixBuilder alloc] init];\ncurBuilder.pluginListener = self; // pluginListener \u56de\u8c03 plugin \u7684\u76f8\u5173\u4e8b\u4ef6\n    \nWCCrashBlockMonitorPlugin *crashBlockPlugin = [[WCCrashBlockMonitorPlugin alloc] init];    \n[curBuilder addPlugin:crashBlockPlugin]; // \u6dfb\u52a0\u5361\u987f\u548c\u5d29\u6e83\u76d1\u63a7\n    \nWCMemoryStatPlugin *memoryStatPlugin = [[WCMemoryStatPlugin alloc] init];\n[curBuilder addPlugin:memoryStatPlugin]; // \u6dfb\u52a0\u5185\u5b58\u76d1\u63a7\u529f\u80fd\n\nWCFPSMonitorPlugin *fpsMonitorPlugin = [[WCFPSMonitorPlugin alloc] init];\n[curBuilder addPlugin:fpsMonitorPlugin]; // \u6dfb\u52a0 fps \u76d1\u63a7\u529f\u80fd\n    \n[matrix addMatrixBuilder:curBuilder];\n    \n[crashBlockPlugin start]; // \u5f00\u542f\u5361\u987f\u548c\u5d29\u6e83\u76d1\u63a7\n[memoryStatPlugin start]; // \u5f00\u542f\u5185\u5b58\u76d1\u63a7\n[fpsMonitorPlugin start]; // \u5f00\u542f fps \u76d1\u63a7\n```\n\n#### \u63a5\u6536\u56de\u8c03\u83b7\u5f97\u76d1\u63a7\u6570\u636e\n\n\u8bbe\u7f6e MatrixBuilder \u5bf9\u8c61\u4e2d\u7684 pluginListener\uff0c\u5b9e\u73b0 MatrixPluginListenerDelegate\u3002\n\n```\n// \u8bbe\u7f6e delegate\n\nMatrixBuilder *curBuilder = [[MatrixBuilder alloc] init];\ncurBuilder.pluginListener = <\u4e00\u4e2a\u9075\u5faa MatrixPluginListenerDelegate \u7684\u5bf9\u8c61>; \n\n// MatrixPluginListenerDelegate\n\n- (void)onInit:(id<MatrixPluginProtocol>)plugin;\n- (void)onStart:(id<MatrixPluginProtocol>)plugin;\n- (void)onStop:(id<MatrixPluginProtocol>)plugin;\n- (void)onDestroy:(id<MatrixPluginProtocol>)plugin;\n- (void)onReportIssue:(MatrixIssue *)issue;\n```\n\n\u5404\u4e2a\u6dfb\u52a0\u5230 MatrixBuilder \u7684 plugin \u4f1a\u5c06\u5bf9\u5e94\u7684\u4e8b\u4ef6\u901a\u8fc7 pluginListener \u56de\u8c03\u3002\n\n**\u91cd\u8981\uff1a\u901a\u8fc7 `onReportIssue:` \u83b7\u5f97 Matrix \u5904\u7406\u540e\u7684\u6570\u636e\uff0c\u76d1\u63a7\u6570\u636e\u683c\u5f0f\u8be6\u89c1\uff1a[Matrix for iOS/macOS \u6570\u636e\u683c\u5f0f\u8bf4\u660e](https://github.com/Tencent/matrix/wiki/Matrix-for-iOS-macOS-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E)**\n\n## Demo\n\n\u81f3\u6b64\uff0cMatrix \u5df2\u7ecf\u96c6\u6210\u5230\u5e94\u7528\u4e2d\u5e76\u4e14\u5f00\u59cb\u6536\u96c6\u5d29\u6e83\u3001\u5361\u987f\u548c\u7206\u5185\u5b58\u6570\u636e\uff0c\u5982\u4ecd\u6709\u7591\u95ee\uff0c\u8bf7\u67e5\u770b\u793a\u4f8b\uff1a`samples/sample-iOS/MatrixDemo`\n\n\n# <a name='matrix_android_cn'>Matrix for Android </a>\n\nMatrix-android \u5f53\u524d\u76d1\u63a7\u8303\u56f4\u5305\u62ec\uff1a\u5e94\u7528\u5b89\u88c5\u5305\u5927\u5c0f\uff0c\u5e27\u7387\u53d8\u5316\uff0c\u542f\u52a8\u8017\u65f6\uff0c\u5361\u987f\uff0c\u6162\u65b9\u6cd5\uff0cSQLite \u64cd\u4f5c\u4f18\u5316\uff0c\u6587\u4ef6\u8bfb\u5199\uff0c\u5185\u5b58\u6cc4\u6f0f\u7b49\u7b49\u3002\n- APK Checker:\n  \u9488\u5bf9 APK \u5b89\u88c5\u5305\u7684\u5206\u6790\u68c0\u6d4b\u5de5\u5177\uff0c\u6839\u636e\u4e00\u7cfb\u5217\u8bbe\u5b9a\u597d\u7684\u89c4\u5219\uff0c\u68c0\u6d4b APK \u662f\u5426\u5b58\u5728\u7279\u5b9a\u7684\u95ee\u9898\uff0c\u5e76\u8f93\u51fa\u8f83\u4e3a\u8be6\u7ec6\u7684\u68c0\u6d4b\u7ed3\u679c\u62a5\u544a\uff0c\u7528\u4e8e\u5206\u6790\u6392\u67e5\u95ee\u9898\u4ee5\u53ca\u7248\u672c\u8ffd\u8e2a\n  \n- Resource Canary:\n  \u57fa\u4e8e WeakReference \u7684\u7279\u6027\u548c [Square Haha](https://github.com/square/haha) \u5e93\u5f00\u53d1\u7684 Activity \u6cc4\u6f0f\u548c Bitmap \u91cd\u590d\u521b\u5efa\u68c0\u6d4b\u5de5\u5177\n  \n- Trace Canary:\n  \u76d1\u63a7ANR\u3001\u754c\u9762\u6d41\u7545\u6027\u3001\u542f\u52a8\u8017\u65f6\u3001\u9875\u9762\u5207\u6362\u8017\u65f6\u3001\u6162\u51fd\u6570\u53ca\u5361\u987f\u7b49\u95ee\u9898\n  \n- SQLite Lint:\n  \u6309\u5b98\u65b9\u6700\u4f73\u5b9e\u8df5\u81ea\u52a8\u5316\u68c0\u6d4b SQLite \u8bed\u53e5\u7684\u4f7f\u7528\u8d28\u91cf\n  \n- IO Canary:\n  \u68c0\u6d4b\u6587\u4ef6 IO \u95ee\u9898\uff0c\u5305\u62ec\uff1a\u6587\u4ef6 IO \u76d1\u63a7\u548c Closeable Leak \u76d1\u63a7\n  \n- Battery Canary:\n  \u76d1\u63a7 App \u6d3b\u8dc3\u7ebf\u7a0b\uff08\u5f85\u673a\u72b6\u6001 & \u524d\u53f0 Loop \u76d1\u63a7\uff09\u3001ASM \u8c03\u7528 (WakeLock/Alarm/Gps/Wifi/Bluetooth \u7b49\u4f20\u611f\u5668)\u3001 \u540e\u53f0\u6d41\u91cf (Wifi/\u79fb\u52a8\u7f51\u7edc)\u7b49 Battery Historian \u7edf\u8ba1 App \u8017\u7535\u7684\u6570\u636e\n  \n- MemGuard\n\n  \u68c0\u6d4b\u5806\u5185\u5b58\u8bbf\u95ee\u8d8a\u754c\u3001\u4f7f\u7528\u91ca\u653e\u540e\u7684\u5185\u5b58\u3001\u91cd\u590d\u91ca\u653e\u7b49\u95ee\u9898\n\n## \u7279\u6027\n\n\u4e0e\u5e38\u89c4\u7684 APM \u5de5\u5177\u76f8\u6bd4\uff0cMatrix \u62e5\u6709\u4ee5\u4e0b\u7279\u70b9\uff1a\n\n#### APK Checker\n\n- \u5177\u6709\u66f4\u597d\u7684\u53ef\u7528\u6027\uff1aJAR \u5305\u65b9\u5f0f\u63d0\u4f9b\uff0c\u66f4\u65b9\u4fbf\u5e94\u7528\u5230\u6301\u7eed\u96c6\u6210\u7cfb\u7edf\u4e2d\uff0c\u4ece\u800c\u8ffd\u8e2a\u548c\u5bf9\u6bd4\u6bcf\u4e2a APK \u7248\u672c\u4e4b\u95f4\u7684\u53d8\u5316\n- \u66f4\u591a\u7684\u68c0\u67e5\u5206\u6790\u529f\u80fd\uff1a\u9664\u5177\u5907 APKAnalyzer \u7684\u529f\u80fd\u5916\uff0c\u8fd8\u652f\u6301\u7edf\u8ba1 APK \u4e2d\u5305\u542b\u7684 R \u7c7b\u3001\u68c0\u67e5\u662f\u5426\u6709\u591a\u4e2a\u52a8\u6001\u5e93\u9759\u6001\u94fe\u63a5\u4e86 STL \u3001\u641c\u7d22 APK \u4e2d\u5305\u542b\u7684\u65e0\u7528\u8d44\u6e90\uff0c\u4ee5\u53ca\u652f\u6301\u81ea\u5b9a\u4e49\u68c0\u67e5\u89c4\u5219\u7b49\n- \u8f93\u51fa\u7684\u68c0\u67e5\u7ed3\u679c\u66f4\u52a0\u8be6\u5b9e\uff1a\u652f\u6301\u53ef\u89c6\u5316\u7684 HTML \u683c\u5f0f\uff0c\u4fbf\u4e8e\u5206\u6790\u5904\u7406\u7684 JSON \uff0c\u81ea\u5b9a\u4e49\u8f93\u51fa\u7b49\u7b49\n\n#### Resource Canary\n\n- \u5206\u79bb\u4e86\u68c0\u6d4b\u548c\u5206\u6790\u90e8\u5206\uff0c\u4fbf\u4e8e\u5728\u4e0d\u6253\u65ad\u81ea\u52a8\u5316\u6d4b\u8bd5\u7684\u524d\u63d0\u4e0b\u6301\u7eed\u8f93\u51fa\u5206\u6790\u540e\u7684\u68c0\u6d4b\u7ed3\u679c\n- \u5bf9\u68c0\u6d4b\u90e8\u5206\u751f\u6210\u7684 Hprof \u6587\u4ef6\u8fdb\u884c\u4e86\u88c1\u526a\uff0c\u79fb\u9664\u4e86\u5927\u90e8\u5206\u65e0\u7528\u6570\u636e\uff0c\u964d\u4f4e\u4e86\u4f20\u8f93 Hprof \u6587\u4ef6\u7684\u5f00\u9500\n- \u589e\u52a0\u4e86\u91cd\u590d Bitmap \u5bf9\u8c61\u68c0\u6d4b\uff0c\u65b9\u4fbf\u901a\u8fc7\u51cf\u5c11\u5197\u4f59 Bitmap \u6570\u91cf\uff0c\u964d\u4f4e\u5185\u5b58\u6d88\u8017\n\n#### Trace Canary\n\n- \u7f16\u8bd1\u671f\u52a8\u6001\u4fee\u6539\u5b57\u8282\u7801, \u9ad8\u6027\u80fd\u8bb0\u5f55\u6267\u884c\u8017\u65f6\u4e0e\u8c03\u7528\u5806\u6808\n- \u51c6\u786e\u7684\u5b9a\u4f4d\u5230\u53d1\u751f\u5361\u987f\u7684\u51fd\u6570\uff0c\u63d0\u4f9b\u6267\u884c\u5806\u6808\u3001\u6267\u884c\u8017\u65f6\u3001\u6267\u884c\u6b21\u6570\u7b49\u4fe1\u606f\uff0c\u5e2e\u52a9\u5feb\u901f\u89e3\u51b3\u5361\u987f\u95ee\u9898\n- \u81ea\u52a8\u6db5\u76d6\u5361\u987f\u3001\u542f\u52a8\u8017\u65f6\u3001\u9875\u9762\u5207\u6362\u3001\u6162\u51fd\u6570\u68c0\u6d4b\u7b49\u591a\u4e2a\u6d41\u7545\u6027\u6307\u6807\n- \u51c6\u786e\u76d1\u63a7ANR\uff0c\u5e76\u4e14\u80fd\u591f\u9ad8\u517c\u5bb9\u6027\u548c\u7a33\u5b9a\u6027\u5730\u4fdd\u5b58\u7cfb\u7edf\u4ea7\u751f\u7684ANR Trace\u6587\u4ef6\n\n#### SQLite Lint\n\n- \u63a5\u5165\u7b80\u5355\uff0c\u4ee3\u7801\u65e0\u4fb5\u5165\n- \u6570\u636e\u91cf\u65e0\u5173\uff0c\u5f00\u53d1\u3001\u6d4b\u8bd5\u9636\u6bb5\u5373\u53ef\u53d1\u73b0SQLite\u6027\u80fd\u9690\u60a3\n- \u68c0\u6d4b\u7b97\u6cd5\u57fa\u4e8e\u6700\u4f73\u5b9e\u8df5\uff0c\u9ad8\u6807\u51c6\u628a\u63a7SQLite\u8d28\u91cf*\n- \u5e95\u5c42\u662f C++ \u5b9e\u73b0\uff0c\u652f\u6301\u591a\u5e73\u53f0\u6269\u5c55\n\n#### IO Canary\n\n- \u63a5\u5165\u7b80\u5355\uff0c\u4ee3\u7801\u65e0\u4fb5\u5165\n- \u6027\u80fd\u3001\u6cc4\u6f0f\u5168\u9762\u76d1\u63a7\uff0c\u5bf9 IO \u8d28\u91cf\u5fc3\u4e2d\u6709\u6570\n- \u517c\u5bb9\u5230 Android P\n\n#### Battery Canary\n\n- \u63a5\u5165\u7b80\u5355\uff0c\u5f00\u7bb1\u5373\u7528\n- \u9884\u7559 Base \u7c7b\u548c Utility \u5de5\u5177\u4ee5\u4fbf\u6269\u5c55\u76d1\u63a7\u7279\u6027\n\n#### Memory Hook\n\n- \u4e00\u4e2a\u68c0\u6d4b Android native \u5185\u5b58\u6cc4\u6f0f\u7684\u5de5\u5177\n- \u65e0\u4fb5\u5165\uff0c\u57fa\u4e8e PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook))\uff0c\u65e0\u9700\u91cd\u7f16 native \u5e93\n- \u9ad8\u6027\u80fd\uff0c\u57fa\u4e8e Wechat-Backtrace \u8fdb\u884c\u5feb\u901f unwind \u5806\u6808\uff0c\u652f\u6301 aarch64 \u548c armeabi-v7a \u67b6\u6784\n\n#### Pthread Hook\n\n- \u4e00\u4e2a\u68c0\u6d4b Android Java \u548c native \u7ebf\u7a0b\u6cc4\u6f0f\u53ca\u7f29\u51cf native \u7ebf\u7a0b\u6808\u7a7a\u95f4\u7684\u5de5\u5177\n- \u65e0\u4fb5\u5165\uff0c\u57fa\u4e8e PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook))\uff0c\u65e0\u9700\u91cd\u7f16 native \u5e93\n- \u901a\u8fc7\u5bf9 native \u7ebf\u7a0b\u7684\u9ed8\u8ba4\u6808\u5927\u5c0f\u8fdb\u884c\u51cf\u534a\u964d\u4f4e\u7ebf\u7a0b\u5e26\u6765\u7684\u865a\u62df\u5185\u5b58\u5f00\u9500\uff0c\u5728 32 \u4f4d\u73af\u5883\u4e0b\u53ef\u7f13\u89e3\u865a\u62df\u5185\u5b58\u4e0d\u8db3\u5bfc\u81f4\u7684\u5d29\u6e83\u95ee\u9898\n\n#### WVPreAllocHook\n\n+ \u4e00\u4e2a\u7528\u4e8e\u5b89\u5168\u91ca\u653e WebView \u9884\u5206\u914d\u5185\u5b58\u4ee5\u5728\u4e0d\u52a0\u8f7d WebView \u65f6\u8282\u7701\u865a\u62df\u5185\u5b58\u7684\u5de5\u5177\uff0c\u5728 32 \u4f4d\u73af\u5883\u4e0b\u53ef\u7f13\u89e3\u865a\u62df\u5185\u5b58\u4e0d\u8db3\u5bfc\u81f4\u7684\u5d29\u6e83\u95ee\u9898\n+ \u65e0\u4fb5\u5165\uff0c\u57fa\u4e8e PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook))\uff0c\u65e0\u9700\u91cd\u7f16 native \u5e93\n+ \u4f7f\u7528\u8be5\u5de5\u5177\u540e WebView \u4ecd\u53ef\u6b63\u5e38\u5de5\u4f5c\n\n#### MemGuard\n\n+ \u4e00\u4e2a\u57fa\u4e8e GWP-Asan \u4fee\u6539\u7684\u5806\u5185\u5b58\u95ee\u9898\u68c0\u6d4b\u5de5\u5177\n+ \u65e0\u4fb5\u5165\uff0c\u57fa\u4e8e PLT-hook([iqiyi/xHook](https://github.com/iqiyi/xHook))\uff0c\u65e0\u9700\u91cd\u7f16 native \u5e93\n+ \u53ef\u6839\u636e\u6b63\u5219\u8868\u8fbe\u5f0f\u6307\u5b9a\u88ab\u68c0\u6d4b\u7684\u76ee\u6807\u5e93\n+ \u53ef\u68c0\u6d4b\u5806\u5185\u5b58\u8bbf\u95ee\u8d8a\u754c\u3001\u4f7f\u7528\u91ca\u653e\u540e\u7684\u5185\u5b58\u548c\u53cc\u91cd\u91ca\u653e\u7b49\u95ee\u9898\n\n#### Backtrace Component\n- \u57fa\u4e8e DWARF \u4ee5\u53ca ARM \u5f02\u5e38\u5904\u7406\u6570\u636e\u8fdb\u884c\u7b80\u5316\u5e76\u751f\u6210\u5168\u65b0\u7684 quicken unwind tables \u6570\u636e\uff0c\u7528\u4e8e\u5b9e\u73b0\u53ef\u5feb\u901f\u56de\u6eaf native \u8c03\u7528\u6808\u7684 backtrace \u7ec4\u4ef6\u3002\u56de\u6eaf\u901f\u5ea6\u7ea6\u662f libunwindstack \u7684 15x ~ 30x \u5de6\u53f3\u3002\n\n## \u4f7f\u7528\u65b9\u6cd5\n\n***\u7531\u4e8e JCenter \u670d\u52a1\u5c06\u4e8e 2022 \u5e74 2 \u6708 1 \u65e5\u4e0b\u7ebf\uff0c\u6211\u4eec\u5df2\u5c06 Matrix \u65b0\u7248\u672c\uff08>= 0.8.0) maven repo \u53d1\u5e03\u81f3 MavenCentral\u3002***\n\n1. \u5728\u4f60\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 gradle.properties \u4e2d\u914d\u7f6e\u8981\u4f9d\u8d56\u7684 Matrix \u7248\u672c\u53f7\uff0c\u5982\uff1a\n``` gradle\n  MATRIX_VERSION=2.1.0\n```\n\n2. \u5728\u4f60\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u7684 build.gradle \u6587\u4ef6\u6dfb\u52a0 Matrix \u4f9d\u8d56\uff0c\u5982\uff1a\n``` gradle \n  dependencies {\n      classpath (\"com.tencent.matrix:matrix-gradle-plugin:${MATRIX_VERSION}\") { changing = true }\n  }\n```\n\n3. \u63a5\u7740\uff0c\u5728 app/build.gradle \u6587\u4ef6\u4e2d\u6dfb\u52a0 Matrix \u5404\u6a21\u5757\u7684\u4f9d\u8d56\uff0c\u5982\uff1a\n``` gradle\n  dependencies {\n    implementation group: \"com.tencent.matrix\", name: \"matrix-android-lib\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-android-commons\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-trace-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-resource-canary-android\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-resource-canary-common\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-io-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-sqlite-lint-android-sdk\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-battery-canary\", version: MATRIX_VERSION, changing: true\n    implementation group: \"com.tencent.matrix\", name: \"matrix-hooks\", version: MATRIX_VERSION, changing: true\n  }\n\n  apply plugin: 'com.tencent.matrix-plugin'\n  matrix {\n    trace {\n        enable = true\t//if you don't want to use trace canary, set false\n        baseMethodMapFile = \"${project.buildDir}/matrix_output/Debug.methodmap\"\n        blackListFile = \"${project.projectDir}/matrixTrace/blackMethodList.txt\"\n    }\n  }\n```\n\n\u76ee\u524d Matrix gradle plugin \u652f\u6301 Android Gradle Plugin 3.5.0/4.0.0/4.1.0\u3002\n\n4. \u5b9e\u73b0 PluginListener\uff0c\u63a5\u6536 Matrix \u5904\u7406\u540e\u7684\u6570\u636e, \u5982\uff1a\n``` java\n  public class TestPluginListener extends DefaultPluginListener {\n    public static final String TAG = \"Matrix.TestPluginListener\";\n    public TestPluginListener(Context context) {\n        super(context);\n        \n    }\n\n    @Override\n    public void onReportIssue(Issue issue) {\n        super.onReportIssue(issue);\n        MatrixLog.e(TAG, issue.toString());\n        \n        //add your code to process data\n    }\n}\n```\n\n5. \u5b9e\u73b0\u52a8\u6001\u914d\u7f6e\u63a5\u53e3\uff0c \u53ef\u4fee\u6539 Matrix \u5185\u90e8\u53c2\u6570. \u5728 sample-android \u4e2d \u6211\u4eec\u6709\u4e2a\u7b80\u5355\u7684\u52a8\u6001\u63a5\u53e3\u5b9e\u4f8b[DynamicConfigImplDemo.java](samples/sample-android/app/src/main/java/sample/tencent/matrix/config/DynamicConfigImplDemo.java), \u5176\u4e2d\u53c2\u6570\u5bf9\u5e94\u7684 key \u4f4d\u4e8e\u6587\u4ef6 [MatrixEnum](samples/sample-android/app/src/main/java/sample/tencent/matrix/config/MatrixEnum.java)\u4e2d\uff0c \u6458\u6284\u90e8\u5206\u793a\u4f8b\u5982\u4e0b\uff1a\n``` java\n  public class DynamicConfigImplDemo implements IDynamicConfig {\n    public DynamicConfigImplDemo() {}\n\n    public boolean isFPSEnable() { return true;}\n    public boolean isTraceEnable() { return true; }\n    public boolean isMatrixEnable() { return true; }\n    public boolean isDumpHprof() {  return false;}\n\n    @Override\n    public String get(String key, String defStr) {\n        //hook to change default values\n    }\n\n    @Override\n    public int get(String key, int defInt) {\n         //hook to change default values\n    }\n\n    @Override\n    public long get(String key, long defLong) {\n        //hook to change default values\n    }\n\n    @Override\n    public boolean get(String key, boolean defBool) {\n        //hook to change default values\n    }\n\n    @Override\n    public float get(String key, float defFloat) {\n        //hook to change default values\n    }\n}\n\n```\n6. \u9009\u62e9\u7a0b\u5e8f\u542f\u52a8\u7684\u4f4d\u7f6e\u5bf9 Matrix \u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5982\u5728 Application \u7684\u7ee7\u627f\u7c7b\u4e2d\uff0c Init \u6838\u5fc3\u903b\u8f91\u5982\u4e0b\uff1a\n``` java \n  Matrix.Builder builder = new Matrix.Builder(application); // build matrix\n  builder.pluginListener(new TestPluginListener(this)); // add general pluginListener\n  DynamicConfigImplDemo dynamicConfig = new DynamicConfigImplDemo(); // dynamic config\n  \n  // init plugin \n  IOCanaryPlugin ioCanaryPlugin = new IOCanaryPlugin(new IOConfig.Builder()\n                    .dynamicConfig(dynamicConfig)\n                    .build());\n  //add to matrix               \n  builder.plugin(ioCanaryPlugin);\n  \n  //init matrix\n  Matrix.init(builder.build());\n\n  // start plugin \n  ioCanaryPlugin.start();\n```\n\n\u81f3\u6b64\uff0cMatrix\u5c31\u5df2\u6210\u529f\u96c6\u6210\u5230\u4f60\u7684\u9879\u76ee\u4e2d\uff0c\u5e76\u4e14\u5f00\u59cb\u6536\u96c6\u548c\u5206\u6790\u6027\u80fd\u76f8\u5173\u5f02\u5e38\u6570\u636e\uff0c\u5982\u4ecd\u6709\u7591\u95ee\uff0c\u8bf7\u67e5\u770b [\u793a\u4f8b](https://github.com/Tencent/Matrix/tree/dev/samples/sample-android/).\n\nPS\uff1a\n1. \u4ece v0.9.0 \u5f00\u59cb\uff0cMatrix for Android \u8fc1\u79fb\u5230\u4e86 AndroidX. \u4f60\u53ef\u80fd\u9700\u8981\u6dfb\u52a0 'android.useAndroidX=true' \u6807\u5fd7\u5230 gradle.properties \u6587\u4ef6\u91cc\u3002\n2. Matrix \u5206\u6790\u540e\u7684\u8f93\u51fa\u5b57\u6bb5\u7684\u542b\u4e49\u8bf7\u67e5\u770b [Matrix \u8f93\u51fa\u5185\u5bb9\u7684\u542b\u4e49\u89e3\u6790](https://github.com/Tencent/matrix/wiki/Matrix-Android--data-format)\n\n\n#### Battery Canary Usage\n\n\u76f8\u5173\u521d\u59cb\u5316\u4ee3\u7801\u5982\u4e0b\uff1a\n```java\nBatteryMonitorConfig config = new BatteryMonitorConfig.Builder()\n        .enable(JiffiesMonitorFeature.class)\n        .enableStatPidProc(true)\n        .greyJiffiesTime(30 * 1000L)\n        .setCallback(new BatteryMonitorCallback.BatteryPrinter())\n        .build();\n\nBatteryMonitorPlugin plugin = new BatteryMonitorPlugin(config);\n```\n\n\u5177\u4f53\u4f7f\u7528\u65b9\u5f0f\uff0c\u8bf7\u53c2\u8003\u5355\u5143\u6d4b\u8bd5\u91cc\u76f8\u5173\u7528\u4f8b\u7684\u4ee3\u7801\uff1a `com.tencent.matrix.batterycanary.ApisTest` \u6216 `sample.tencent.matrix.battery.BatteryCanaryInitHelper`.\n\n#### Backtrace Component Usage\n\n\u5982\u4f55\u521d\u59cb\u5316 backtrace \u7ec4\u4ef6\uff1a\n```java\nWeChatBacktrace.instance().configure(getApplicationContext()).commit();\n```\n\n\u521d\u59cb\u5316\u540e\u5176\u4ed6 Matrix \u7ec4\u4ef6\u5c31\u53ef\u4ee5\u4f7f\u7528 Quicken Backtrace \u8fdb\u884c\u56de\u6eaf\u3002\u66f4\u591a\u53c2\u6570\u7684\u914d\u7f6e\u8bf7\u67e5\u770b WeChatBacktrace.Configuration \u7684\u63a5\u53e3\u6ce8\u91ca\u3002\n\n#### APK Checker\n\nAPK Check \u4ee5\u72ec\u7acb\u7684 jar \u5305\u63d0\u4f9b ([matrix-apk-canary-2.1.0.jar](https://repo.maven.apache.org/maven2/com/tencent/matrix/matrix-apk-canary/2.1.0/matrix-apk-canary-2.1.0.jar)\uff09\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\uff1a\n\n```cmd\njava -jar matrix-apk-canary-2.1.0.jar\n```\n\n\u67e5\u770b Usages \u6765\u4f7f\u7528\u5b83\u3002\n\n```\nUsages: \n    --config CONFIG-FILE-PATH\nor\n    [--input INPUT-DIR-PATH] [--apk APK-FILE-PATH] [--unzip APK-UNZIP-PATH] [--mappingTxt MAPPING-FILE-PATH] [--resMappingTxt RESGUARD-MAPPING-FILE-PATH] [--output OUTPUT-PATH] [--format OUTPUT-FORMAT] [--formatJar OUTPUT-FORMAT-JAR] [--formatConfig OUTPUT-FORMAT-CONFIG (json-array format)] [Options]\n    \nOptions:\n-manifest\n     Read package info from the AndroidManifest.xml.\n-fileSize [--min DOWN-LIMIT-SIZE (KB)] [--order ORDER-BY ('asc'|'desc')] [--suffix FILTER-SUFFIX-LIST (split by ',')]\n     Show files whose size exceed limit size in order.\n-countMethod [--group GROUP-BY ('class'|'package')]\n     Count methods in dex file, output results group by class name or package name.\n-checkResProguard\n     Check if the resguard was applied.\n-findNonAlphaPng [--min DOWN-LIMIT-SIZE (KB)]\n     Find out the non-alpha png-format files whose size exceed limit size in desc order.\n-checkMultiLibrary\n     Check if there are more than one library dir in the 'lib'.\n-uncompressedFile [--suffix FILTER-SUFFIX-LIST (split by ',')]\n     Show uncompressed file types.\n-countR\n     Count the R class.\n-duplicatedFile\n     Find out the duplicated resource files in desc order.\n-checkMultiSTL  --toolnm TOOL-NM-PATH\n     Check if there are more than one shared library statically linked the STL.\n-unusedResources --rTxt R-TXT-FILE-PATH [--ignoreResources IGNORE-RESOURCES-LIST (split by ',')]\n     Find out the unused resources.\n-unusedAssets [--ignoreAssets IGNORE-ASSETS-LIST (split by ',')]\n     Find out the unused assets file.\n-unstrippedSo  --toolnm TOOL-NM-PATH\n     Find out the unstripped shared library file.\n```\n\n\u7531\u4e8e\u7bc7\u5e45\u5f71\u54cd\uff0c\u6b64\u6b21\u4e0d\u518d\u8d58\u8ff0\uff0c\u6211\u4eec\u5728 [Matrix-APKChecker](https://github.com/Tencent/matrix/wiki/Matrix-Android-ApkChecker) \u4e2d\u8fdb\u884c\u4e86\u8be6\u7ec6\u8bf4\u660e\u3002\n\n\n# Support\n\n\u8fd8\u6709\u5176\u4ed6\u95ee\u9898\uff1f\n\n1. \u67e5\u770b[\u793a\u4f8b](https://github.com/Tencent/matrix/tree/master/samples)\uff1b\n2. \u9605\u8bfb[\u6e90\u7801](https://github.com/Tencent/matrix/tree/master/matrix)\uff1b\n3. \u9605\u8bfb [Wiki](https://github.com/Tencent/matrix/wiki) \u6216 [FAQ](https://github.com/Tencent/Matrix/wiki/Matrix-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98)\uff1b\n4. \u8054\u7cfb\u6211\u4eec\u3002\n\n# \u53c2\u4e0e\u8d21\u732e\n\n\u5173\u4e8e Matrix \u5206\u652f\u7ba1\u7406\u3001issue \u4ee5\u53ca pr \u89c4\u8303\uff0c\u8bf7\u9605\u8bfb [Matrix Contributing Guide](https://github.com/Tencent/Matrix/blob/master/CONTRIBUTING.md)\u3002\n\n[\u817e\u8baf\u5f00\u6e90\u6fc0\u52b1\u8ba1\u5212](https://opensource.tencent.com/contribution) \u9f13\u52b1\u5f00\u53d1\u8005\u7684\u53c2\u4e0e\u548c\u8d21\u732e\uff0c\u671f\u5f85\u4f60\u7684\u52a0\u5165\u3002\n\n# License\n\nMatrix is under the BSD license. See the [LICENSE](https://github.com/Tencent/Matrix/blob/master/LICENSE) file for details\n\n# \u4fe1\u606f\u516c\u793a\n\n- SDK\u540d\u79f0\uff1aMatrix\n- \u7248\u672c\u53f7\uff1a2.1.0\n- \u5f00\u53d1\u8005\uff1a\u6df1\u5733\u5e02\u817e\u8baf\u8ba1\u7b97\u673a\u7cfb\u7edf\u6709\u9650\u516c\u53f8\n- \u4e3b\u8981\u529f\u80fd\uff1aMatrix\u662f\u5fae\u4fe1\u7814\u53d1\u5e76\u65e5\u5e38\u4f7f\u7528\u7684\u5e94\u7528\u6027\u80fd\u76d1\u63a7\u5de5\u5177\uff0c\u652f\u6301iOS\u3001macOS\u548cAndroid\u3002Matrix\u901a\u8fc7\u63a5\u5165\u95ea\u9000\u3001\u5361\u987f\u3001\u8017\u7535\u3001\u5185\u5b58\u7b49\u65b9\u9762\u7684\u76d1\u63a7\u65b9\u6848\uff0c\u5bf9\u6027\u80fd\u76d1\u63a7\u9879\u7684\u5f02\u5e38\u6570\u636e\u8fdb\u884c\u91c7\u96c6\u548c\u5206\u6790\uff0c\u8f93\u51fa\u76f8\u5e94\u7684\u95ee\u9898\u5206\u6790\u3001\u5b9a\u4f4d\u4e0e\u4f18\u5316\u5efa\u8bae\uff0c\u4ece\u800c\u5e2e\u52a9\u5f00\u53d1\u8005\u5f00\u53d1\u51fa\u66f4\u9ad8\u8d28\u91cf\u7684\u5e94\u7528\u3002\n- [Matrix SDK\u4f7f\u7528\u8bf4\u660e](https://github.com/Tencent/matrix)\n- [Matrix SDK\u4e2a\u4eba\u4fe1\u606f\u4fdd\u62a4\u89c4\u5219](https://support.weixin.qq.com/cgi-bin/mmsupportacctnodeweb-bin/pages/yTezupX6yF028Mpf)\n",
        "releases": [
            {
                "name": "v2.1.0/2023-03-21",
                "date": "2023-03-21T09:24:57Z"
            },
            {
                "name": "v2.0.8/2022-05-07",
                "date": "2022-05-07T12:14:58Z"
            },
            {
                "name": "Matrix 2.0.6 for iOS/MacOS",
                "date": "2022-03-02T02:43:31Z"
            },
            {
                "name": "v2.0.5/2022-01-21",
                "date": "2022-01-21T13:10:07Z"
            },
            {
                "name": "v2.0.2/2021-11-01",
                "date": "2021-11-01T12:54:42Z"
            },
            {
                "name": "v2.0.1/2021-09-28",
                "date": "2021-09-28T12:20:37Z"
            },
            {
                "name": "v2.0.0/2021-08-03",
                "date": "2021-08-03T07:38:52Z"
            },
            {
                "name": "v1.0.1/2021-06-29",
                "date": "2021-06-29T08:03:44Z"
            },
            {
                "name": "v1.0.0/2021-06-17",
                "date": "2021-06-17T07:51:55Z"
            },
            {
                "name": "v0.9.0/2021-04-27",
                "date": "2021-04-27T09:17:27Z"
            },
            {
                "name": "v0.8.1/2021-04-23",
                "date": "2021-04-23T11:46:15Z"
            },
            {
                "name": "v0.6.5/2019-11-26 ",
                "date": "2019-11-26T11:55:53Z"
            },
            {
                "name": "v0.6.0/2019-08-08 ",
                "date": "2019-08-08T09:33:48Z"
            },
            {
                "name": "v0.5.2/2019-07-05",
                "date": "2019-07-05T12:08:59Z"
            },
            {
                "name": "v0.5.1/2019-04-16 ",
                "date": "2019-04-17T08:07:59Z"
            },
            {
                "name": "v0.4.10/2019-01-02",
                "date": "2019-01-02T06:15:40Z"
            }
        ]
    }
}