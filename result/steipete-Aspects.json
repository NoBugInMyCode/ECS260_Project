{
    "https://api.github.com/repos/steipete/Aspects": {
        "forks": 1266,
        "watchers": 8400,
        "stars": 8400,
        "languages": {
            "Objective-C": 77571,
            "Ruby": 625
        },
        "commits": [
            "2019-02-05T10:02:57Z",
            "2019-02-05T09:07:39Z",
            "2016-06-08T08:27:56Z",
            "2016-06-08T01:48:25Z",
            "2015-11-03T10:56:51Z",
            "2015-11-02T23:02:09Z",
            "2015-08-27T09:18:35Z",
            "2015-08-27T04:02:33Z",
            "2015-08-27T02:48:54Z",
            "2015-08-27T02:07:10Z",
            "2015-08-27T02:05:34Z",
            "2015-08-27T02:01:12Z",
            "2015-08-27T01:59:50Z",
            "2015-06-04T13:25:40Z",
            "2015-06-04T13:21:50Z",
            "2015-06-04T13:21:43Z",
            "2015-06-04T13:19:59Z",
            "2015-06-04T13:19:44Z",
            "2015-06-04T13:17:35Z",
            "2015-06-04T13:17:02Z",
            "2015-06-02T20:42:49Z",
            "2015-05-25T16:57:10Z",
            "2015-05-24T20:42:35Z",
            "2015-05-24T20:41:58Z",
            "2015-04-01T13:21:48Z",
            "2015-03-31T18:07:50Z",
            "2015-02-07T18:37:38Z",
            "2015-02-07T05:45:45Z",
            "2014-12-10T04:12:24Z",
            "2014-05-28T13:03:10Z"
        ],
        "creation_date": "2014-05-03T17:06:00Z",
        "contributors": 15,
        "topics": [
            "aspects",
            "hooks",
            "objective-c",
            "objectivec",
            "swift"
        ],
        "subscribers": 276,
        "readme": "Aspects v1.4.2 [![Build Status](https://travis-ci.org/steipete/Aspects.svg?branch=master)](https://travis-ci.org/steipete/Aspects) [![Carthage compatible](https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat)](https://github.com/Carthage/Carthage)\n==============\n\nA delightful, simple library for aspect oriented programming by [@steipete](http://twitter.com/steipete).\n\n**Think of Aspects as method swizzling on steroids. It allows you to add code to existing methods per class or per instance**, whilst thinking of the insertion point e.g. before/instead/after. Aspects automatically deals with calling super and is easier to use than regular method swizzling.\n\nAspects hooks deep into the class hierarchy and creates dynamic subclasses, much like KVO. There's known issues with this approach, and to this date (February 2019) **I STRICTLY DO NOT RECOMMEND TO USE Aspects IN PRODUCTION CODE**. We use it for partial test mocks in, [PSPDFKit, an iOS PDF framework that ships with apps like Dropbox or Evernote](http://pspdfkit.com), it's also very useful for quickly hacking something up.\n\nAspects uses `_objc_msgForward` which causes issues with other code that uses message forwarding.\n\nAspects extends `NSObject` with the following methods:\n\n``` objc\n/// Adds a block of code before/instead/after the current `selector` for a specific class.\n///\n/// @param block Aspects replicates the type signature of the method being hooked.\n/// The first parameter will be `id<AspectInfo>`, followed by all parameters of the method.\n/// These parameters are optional and will be filled to match the block signature.\n/// You can even use an empty block, or one that simple gets `id<AspectInfo>`.\n///\n/// @note Hooking static methods is not supported.\n/// @return A token which allows to later deregister the aspect.\n+ (id<AspectToken>)aspect_hookSelector:(SEL)selector\n                      withOptions:(AspectOptions)options\n                       usingBlock:(id)block\n                            error:(NSError **)error;\n\n/// Adds a block of code before/instead/after the current `selector` for a specific instance.\n- (id<AspectToken>)aspect_hookSelector:(SEL)selector\n                      withOptions:(AspectOptions)options\n                       usingBlock:(id)block\n                            error:(NSError **)error;\n\n/// Deregister an aspect.\n/// @return YES if deregistration is successful, otherwise NO.\nid<AspectToken> aspect = ...;\n[aspect remove];\n```\n\nAdding aspects returns an opaque token of type `AspectToken` which can be used to deregister again. All calls are thread-safe.\n\nAspects uses Objective-C message forwarding to hook into messages. This will create some overhead. Don't add aspects to methods that are called a lot. Aspects is meant for view/controller code that is not called 1000 times per second.\n\nAspects calls and matches block arguments. Blocks without arguments are supported as well. The first block argument will be of type `id<AspectInfo>`.\n\nWhen to use Aspects\n-------------------\nAspect-oriented programming (AOP) is used to encapsulate \"cross-cutting\" concerns. These are the kind of requirements that *cut-across* many modules in your system, and so cannot be encapsulated using normal object oriented programming. Some examples of these kinds of requirements: \n\n* *Whenever* a user invokes a method on the service client, security should be checked. \n* *Whenever* a user interacts with the store, a genius suggestion should be presented, based on their interaction. \n* *All* calls should be logged. \n\nIf we implemented the above requirements using regular OOP there'd be some drawbacks: \n\nGood OOP says a class should have a single responsibility, however adding on extra *cross-cutting* requirements means a class that is taking on other responsibilites. For example you might have a **StoreClient** that is supposed to be all about making purchases from an online store. Add in some cross-cutting requirements and it might also have to take on the roles of logging, security and recommendations. This is not great because: \n\n* Our StoreClient is now harder to understand and maintain.\n* These cross-cutting requirements are duplicated and spread throughout our app. \n\nAOP lets us modularize these cross-cutting requirements, and then cleanly identify all of the places they should be applied. As shown in the examples above cross-cutting requirements can be either technical or business focused in nature.  \n\n## Here are some concrete examples: \n\n\nAspects can be used to **dynamically add logging** for debug builds only:\n\n``` objc\n[UIViewController aspect_hookSelector:@selector(viewWillAppear:) withOptions:AspectPositionAfter usingBlock:^(id<AspectInfo> aspectInfo, BOOL animated) {\n    NSLog(@\"View Controller %@ will appear animated: %tu\", aspectInfo.instance, animated);\n} error:NULL];\n```\n\n-------------------\nIt can be used to greatly simplify your analytics setup:\nhttps://github.com/orta/ARAnalytics\n\n-------------------\nYou can check if methods are really being called in your test cases:\n``` objc\n- (void)testExample {\n    TestClass *testClass = [TestClass new];\n    TestClass *testClass2 = [TestClass new];\n\n    __block BOOL testCallCalled = NO;\n    [testClass aspect_hookSelector:@selector(testCall) withOptions:AspectPositionAfter usingBlock:^{\n        testCallCalled = YES;\n    } error:NULL];\n\n    [testClass2 testCallAndExecuteBlock:^{\n        [testClass testCall];\n    } error:NULL];\n    XCTAssertTrue(testCallCalled, @\"Calling testCallAndExecuteBlock must call testCall\");\n}\n```\n-------------------\nIt can be really useful for debugging. Here I was curious when exactly the tap gesture changed state:\n\n``` objc\n[_singleTapGesture aspect_hookSelector:@selector(setState:) withOptions:AspectPositionAfter usingBlock:^(id<AspectInfo> aspectInfo) {\n    NSLog(@\"%@: %@\", aspectInfo.instance, aspectInfo.arguments);\n} error:NULL];\n```\n\n-------------------\nAnother convenient use case is adding handlers for classes that you don't own. I've written it for use in [PSPDFKit](http://pspdfkit.com), where we require notifications when a view controller is being dismissed modally. This includes UIKit view controllers like `MFMailComposeViewController` and `UIImagePickerController`. We could have created subclasses for each of these controllers, but this would be quite a lot of unnecessary code. Aspects gives you a simpler solution for this problem:\n\n``` objc\n@implementation UIViewController (DismissActionHook)\n\n// Will add a dismiss action once the controller gets dismissed.\n- (void)pspdf_addWillDismissAction:(void (^)(void))action {\n    PSPDFAssert(action != NULL);\n\n    [self aspect_hookSelector:@selector(viewWillDisappear:) withOptions:AspectPositionAfter usingBlock:^(id<AspectInfo> aspectInfo) {\n        if ([aspectInfo.instance isBeingDismissed]) {\n            action();\n        }\n    } error:NULL];\n}\n\n@end\n```\n\nDebugging\n---------\nAspects identifies itself nicely in the stack trace, so it's easy to see if a method has been hooked:\n\n<img src=\"https://raw.githubusercontent.com/steipete/Aspects/master/stacktrace@2x.png?token=58493__eyJzY29wZSI6IlJhd0Jsb2I6c3RlaXBldGUvQXNwZWN0cy9tYXN0ZXIvc3RhY2t0cmFjZUAyeC5wbmciLCJleHBpcmVzIjoxMzk5NzQ3OTI3fQ%3D%3D--97cf7e7bac491149eb8db3d1b9a562ab88154a3c\" width=\"75%\">\n\nUsing Aspects with non-void return types\n----------------------------------------\n\nYou can use the invocation object to customize the return value:\n\n``` objc\n    [PSPDFDrawView aspect_hookSelector:@selector(shouldProcessTouches:withEvent:) withOptions:AspectPositionInstead usingBlock:^(id<AspectInfo> info, NSSet *touches, UIEvent *event) {\n        // Call original implementation.\n        BOOL processTouches;\n        NSInvocation *invocation = info.originalInvocation;\n        [invocation invoke];\n        [invocation getReturnValue:&processTouches];\n\n        if (processTouches) {\n            processTouches = pspdf_stylusShouldProcessTouches(touches, event);\n            [invocation setReturnValue:&processTouches];\n        }\n    } error:NULL];\n```\n\nInstallation\n------------\nThe simplest option is to use `pod \"Aspects\"`.\n\nYou can also add the two files `Aspects.h/m` to your project. There are no further requirements.\n\nCompatibility and Limitations\n-----------------------------\nAspects uses quite some runtime trickery to achieve what it does. You can mostly mix this with regular method swizzling.\n\nAn important limitation is that for class-based hooking, a method can only be hooked once within the subclass hierarchy. [See #2](https://github.com/steipete/Aspects/issues/2)\nThis does not apply for objects that are hooked. Aspects creates a dynamic subclass here and has full control.\n\nKVO works if observers are created after your calls `aspect_hookSelector:` It most likely will crash the other way around. Still looking for workarounds here - any help appreciated.\n\nBecause of ugly implementation details on the ObjC runtime, methods that return unions that also contain structs might not work correctly unless this code runs on the arm64 runtime.\n\nCredits\n-------\nThe idea to use `_objc_msgForward` and parts of the `NSInvocation` argument selection is from the excellent [ReactiveCocoa](https://github.com/ReactiveCocoa/ReactiveCocoa) from the GitHub guys. [This article](http://codeshaker.blogspot.co.at/2012/01/aop-delivered.html) explains how it works under the hood.\n\n\nSupported iOS & SDK Versions\n-----------------------------\n\n* Aspects requires ARC.\n* Aspects is tested with iOS 7+ and OS X 10.7 or higher.\n\nLicense\n-------\nMIT licensed, Copyright (c) 2014 Peter Steinberger, steipete@gmail.com, [@steipete](http://twitter.com/steipete)\n\n\nRelease Notes\n-----------------\n\nVersion 1.4.2\n\n- Allow to hook different subclasses.\n- Smaller tweaks.\n\nVersion 1.4.1\n\n- Rename error codes.\n\nVersion 1.4.0\n\n- Add support for block signatures that match method signatures. (thanks to @nickynick)\n\nVersion 1.3.1\n\n- Add support for OS X 10.7 or higher. (thanks to @ashfurrow)\n\nVersion 1.3.0\n\n- Add automatic deregistration.\n- Checks if the selector exists before trying to hook.\n- Improved dealloc hooking. (no more unsafe_unretained needed)\n- Better examples.\n- Always log errors.\n\nVersion 1.2.0\n\n- Adds error parameter.\n- Improvements in subclassing registration tracking.\n\nVersion 1.1.0\n\n- Renamed the files from NSObject+Aspects.m/h to just Aspects.m/h.\n- Removing now works via calling `remove` on the aspect token.\n- Allow hooking dealloc.\n- Fixes infinite loop if the same method is hooked for multiple classes. Hooking will only work for one class in the hierarchy.\n- Additional checks to prevent things like hooking retain/release/autorelease or forwardInvocation:\n- The original implementation of forwardInvocation is now correctly preserved.\n- Classes are properly cleaned up and restored to the original state after the last hook is deregistered.\n- Lots and lots of new test cases!\n\nVersion 1.0.1\n\n- Minor tweaks and documentation improvements.\n\nVersion 1.0.0\n\n- Initial release\n",
        "releases": [
            {
                "name": "",
                "date": "2014-05-05T16:24:29Z"
            },
            {
                "name": "",
                "date": "2014-05-05T16:23:33Z"
            },
            {
                "name": "",
                "date": "2014-05-05T16:23:46Z"
            },
            {
                "name": "",
                "date": "2014-05-05T16:23:55Z"
            },
            {
                "name": "",
                "date": "2014-05-05T16:24:11Z"
            },
            {
                "name": "",
                "date": "2014-05-05T16:24:17Z"
            }
        ]
    }
}